# A-lightweight-Unsupervised-Feature-Extractor
## 簡介（）
本模型透過ROI技術以當下的偵測框切分YOLO骨幹網路中的深層特徵訓練而成，以骨幹網路最後一層的 `SPP-CSPC` 作為唯一的特徵來源，並將其以邊界框切分後形成數個不同的片段，最終將各個不同的片段重塑為(10,10)的形狀方便後續的訓練與推論。

作為一個 Encoder 透過接收形狀為 `[1, 512, Hf, Wf]` 的張量進行訓練與推論,透過 ROI Align 將對應區域的特徵裁剪與重採樣為固定大小之 ROI 特徵 並依據當下偵測框的數量將特徵形狀重塑為 `[N, 512, 10, 10]`，其中 
𝑁 為該影像中偵測框的數量。

| 階段           | 張量形狀                       | 說明                  |
| ------------ | -------------------------- | ------------------- |
| Backbone 輸出  | `[1, 512, Hf, Wf]`         | YOLOv7 SPP-CSPC 特徵圖 |
| 偵測框          | `[N, 4]`                   | 每個物件的 bounding box  |
| ROI Align 輸入 | `[1, 512, Hf, Wf] + [N,5]` | 加上 batch index |
| ROI Align 輸出 | `[N, 512, 10, 10]`         | 固定大小 ROI 特徵         |

> [!NOTE]
>
>  ROI Align 時為單圖擷取因此該階端的batch index 皆為0，直至搜集完全資料集中圖像之 ROI 特徵才透過DataLoader將 ROI Dataset 編入正式的batch index  

為驗證本模型於不同畫面下的相同物件之辨識能力，利用不同幀下的標記圖像評估模型的辨識能力，該驗證資料集透過透過成對的圖像與標記檔模擬不同幀下的圖像輸入，其中為確保指標計算得以正常進行標記檔中至少存在一個跨越不同幀的物件。
